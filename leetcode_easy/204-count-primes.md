## 204. 计数质数

2020-12-05 16:27:52

### 题目

统计所有小于非负整数*``n``*的质数的数量。

 
**示例 1：**

```
输入：n = 10
输出：4
解释：小于 10 的质数一共有 4 个, 它们是 2, 3, 5, 7 。
```

**示例 2：**

```
输入：n = 0
输出：0
```

**示例 3：**

```
输入：n = 1
输出：0
```

**提示：**

- ``0 <= n <= 5 * 10<sup>6</sup>``


### 思路及代码

首先想到的是暴力做法，用函数判断从1到n的数是否为质数，但是这样存在大量的重复计算，不可取。

相对而言推荐的做法是使用质数筛，建立一个长度为n的数组，将从2开始各个数的倍数排除掉，剩下的数都是质数。这里还有可以优化的空间，对于当前遍历到的数字i，计算倍数的起始位置应该是``i * i``。以5为例，数字10、15、20已经在计算2、3的倍数时排除掉，此时便不用重复判断，直接从25开始。

但上面的做法仍旧存在许多重复计算的情况，例如计算4的倍数时会和计算2的倍数时有一些交叉，但相较于暴力做法性能有了较大的进步。

```cpp
class Solution {
public:
    int countPrimes(int n) {
        vector<int> isPrime(n, 1);
        int res = 0;
        for(int i = 2; i < n; i++){
            if(isPrime[i]){
                res++;

                if((long long)i * i < n){
                    for(int j = i * i; j < n; j += i){
                        isPrime[j] = 0;
                    }
                }
            }
        }
        return res;
    }
};
```